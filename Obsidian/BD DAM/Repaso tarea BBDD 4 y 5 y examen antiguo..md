## Tarea 4:
### Ejercicio 1
```sql
SELECT E.APE1, E.APE2, E.NOMBRE FROM EMPLEADO E JOIN DPTO D ON E.CODEMPLE=D.CODEMPLEJEFE WHERE SALARIO>1.2*(SELECT MAX(SALARIO) FROM EMPLEADO WHERE CODDPTO=D.CODDPTO) ORDER BY APE1, APE2, NOMBRE;
```
### Ejercicio 2
```SQL
SELECT E.NOMBRE, E.APE1, E.APE2 FROM EMPLEADO E WHERE SALARIO<(SELECT AVG(SALARIO) FROM EMPLEADO WHERE CODDPTO=E.CODDPTO AND CODEMPLE!=E.CODEMPLE);
```
### Ejercicio 3
```SQL
SELECT D.CODCENTRO, E.SALARIO*166 AS SALARIO_PESETAS FROM EMPLEADO E JOIN DPTO D ON E.CODDPTO=D.CODDPTO WHERE E.SALARIO=(SELECT MAX(SALARIO) FROM EMPLEADO WHERE CODDPTO=E.CODDPTO GROUP BY CODDPTO);
```

### Ejercicio 4
```SQL
SELECT E1.CODEMPLE, E2.CODEMPLE FROM EMPLEADO E1, EMPLEADO E2 WHERE E1.CODDPTO!=E2.CODDPTO;
```

### Ejercicio 5
```SQL
SELECT E.NOMBRE FROM EMPLEADO E WHERE E.SALARIO<(SELECT MIN(SALARIO) FROM EMPLEADO WHERE CODDPTO=1);
```
### Ejercicio 6
```SQL
SELECT E.NOMBRE FROM EMPLEADO E JOIN DPTO D ON E.CODDPTO=D.CODDPTO JOIN EMPLEADO J ON J.CODEMPLE=D.CODEMPLEJEFE WHERE E.FECHAINGRESO>J.FECHAINGRESO;
```
### Ejercicio 7
```SQL
SELECT E.NOMBRE, E.CODDPTO, D.DENOMINACION FROM EMPLEADO E JOIN DPTO D ON E.CODDPTO=D.CODDPTO WHERE D.DENOMINACION LIKE '%C%' OR D.DENOMINACION='NULL';
```
### Ejercicio 8
```sql
SELECT E.NOMBRE, E.LOCALIDAD, C.NOMBRE, C.LOCALIDAD FROM EMPLEADO E JOIN DPTO D ON E.CODDPTO=D.CODDPTO JOIN CENTRO C ON D.CODCENTRO=C.CODCENTRO WHERE E.LOCALIDAD=C.LOCALIDAD;
```
### Ejercicio 9
```SQL
SELECT C.LOCALIDAD FROM CENTRO C JOIN DPTO D ON C.CODCENTRO=D.CODCENTRO JOIN EMPLEADO E ON D.CODDPTO=E.CODDPTO HAVING COUNT(E.NOMBRE)>2 GROUP BY C.LOCALIDAD;
```
## Tarea 5:

### Ejercicio 1
```sql
INSERT INTO PROFESORADO (CODIGO, NOMBRE, APE1, APE2, DNI, ESPECIALIDAD, FECHA_NAC, ANTIGUEDAD) VALUES (1, 'NURIA', 'ANERO', 'GONZALEZ', '58339033X', 'MATEMATICAS', '22-02-1972', 9)
```
### Ejercicio 2
```SQL
INSERT INTO PROFESORADO (CODIGO, NOMBRE, APE1, APE2, DNI, ESPECIALIDAD, FECHA_NAC, ANTIGUEDAD) VALUES (2, 'MARIA LUISA', 'FABRE', 'BERDUN', '51082089F', 'TECNOLOGIA', '31-03-1975', 4);

INSERT INTO PROFESORADO (NOMBRE, APE1, APE2) VALUES ('JOSE M.', 'ANERO', 'PAYAN');
```
### Ejercicio 3
```SQL
UPDATE CURSOS SET COD_PROFE=4 WHERE CODIGO=1;
```
### Ejercicio 4
```SQL
UPDATE PROFESORADO SET FECHA_NAC='31-03-1976' WHERE NOMBRE='MARIA LUISA';
UPDATE PROFESORADO SET ANTIGUEDAD=2 WHERE NOMBRE='MARIA LUISA';
```
### Ejercicio 5
```SQL
UPDATE PROFESORADO SET ANTIGUEDAD=ANTIGUEDAD+1;
```
### Ejercicio 6
```SQL
DELETE FROM CURSOS WHERE CODIGO=6;
```
### Ejercicio 7
```SQL
DELETE FROM ALUMNADO WHERE COD_CURSO=3;
```
### Ejercicio 8
```SQL
INSERT INTO ALUMNADO (NOMBRE, APELLIDOS, SEXO, FECHA_NAC) VALUES NOMBRE, APELLIDOS, SEXO, FECHA_NAC WHERE SEXO='M';
```
### Ejercicio 9
```SQL
UPDATE CURSOS SET MAX_ALUMN=(SELECT COUNT(*) FROM ALUMNADO WHERE SEXO='M' AND COD_CURSO=2) WHERE COD_CURSO=2;
```
### Ejercicio 10
```SQL
DELETE FROM ALUMNADO WHERE COD_CURSO=(SELECT COD_CURSO FROM CURSOS WHERE COD_PROFE=(SELECT COD_PROFE FROM PROFESORADO WHERE NOMBRE='JAVIER'));
```
## Examen antiguo:
### Ejercicio 1
```sql
SELECT E.NOMBRE, E.APE1, E.APE2, E.SALARIO+E.COMISION AS SALARIO_TOTAL FROM EMPLEADO E WHERE SALARIO+COMISION IN (SELECT MAX(SALARIO+COMISION) FROM EMPLEADO);
```
```sql
SELECT E.NOMBRE, E.APE1, E.SALARIO+E.COMISION AS SALARIO_TOTAL FROM EMPLEADO E ORDER BY SALARIO_TOTAL DESC LIMIT 1;
```
### Ejercicio 2
```SQL
SELECT D.CODDPTO, D.DENOMINACION, MAX(E.SALARIO) FROM DPTO D JOIN EMPLEADO E ON D.CODDPTO=D.CODDPTO GROUP BY D.CODDPTO, D.DENOMINACION;
```
### Ejercicio 3
```SQL
SELECT D.CODDPTO, D.DENOMINACION FROM DPTO D WHERE D.CODDPTO NOT IN (SELECT CODDPTO FROM EMPLEADO);
```
### Ejercicio 4
```SQL
SELECT D.CODDPTO, D.DENOMINACION, COUNT(E.NOMBRE), SUM(E.SALARIO) FROM DPTO D JOIN EMPLEADO E ON D.CODDPTO=E.CODDPTO GROUP BY D.CODDPTO, D.DENOMINACION HAVING E.SALARIO>=1500 AND COUNT(E.NOMBRE)>2 AND SUM(E.SALARIO)>=6000;
```
Está mal porque el filtro E.SALARIO va antes con WHERE y después se aplica el GROUP BY y el HAVING. Una forma de hacerlo sin el WHERE sería usar el filtro de grupo MIN(E.SALARIO)>=1500;
```SQL
SELECT D.CODDPTO, D.DENOMINACION, COUNT(E.CODEMPLE) AS NUM_EMPLEADOS, SUM(E.SALARIO) AS TOTAL_SALARIO FROM DPTO D JOIN EMPLEADO E ON D.CODDPTO=E.CODDPTO GROUP BY D.CODDPTO, D.DENOMINACION HAVING COUNT(E.CODEMPLE)>=3 AND SUM(E.SALARIO)>=6000 AND MIN(E.SALARIO)>=1500;
```
### Ejercicio 5
```SQL
SELECT E.CODEMPLE, E.APE1, E.APE2, E.NOMBRE, E.SALARIO FROM EMPLEADO E JOIN DPTO D ON E.CODEMPLE=D.CODEMPLEJEFE WHERE E.SALARIO<SOME(SELECT SALARIO FROM EMPLEADO WHERE CODDPTO=E.CODDPTO);
```
También:
```SQL
SELECT E.CODEMPLE, E.APE1, E.APE2, E.NOMBRE, E.SALARIO FROM EMPLEADO E JOIN DPTO D ON E.CODEMPLE=D.CODEMPLEJEFE WHERE E.SALARIO<(SELECT MAX(SALARIO) FROM EMPLEADO WHERE CODDPTO=E.CODDPTO);
```
### Ejercicio 6
```SQL
UPDATE EMPLEADO SET SALARIO=SALARIO*1.05 WHERE CODDPTO IN (SELECT E.CODDPTO FROM EMPLEADO E GROUP BY E.CODDPTO HAVING COUNT(E.CODEMPLE)>10);
```
En las consultas IN solo debe devolver un campo la subconsulta.
### Ejercicio 7
```sql
DELETE FROM CENTRO WHERE LOCALIDAD!='MADRID' AND CODCENTRO NOT IN (SELECT D.CODCENTRO FROM DPTO D);
```
### Ejercicio 8
```SQL
SELECT D.CODDPTO, D.DENOMINACION FROM EMPLEADO E JOIN DPTO D ON E.CODDPTO=D.CODDPTO JOIN CENTRO C ON D.CODCENTRO=C.CODCENTRO WHERE E.LOCALIDAD=C.LOCALIDAD GROUP BY D.CODDPTO, D.DENOMINACION HAVING COUNT(DISTINCT E.EDAD)=1;
```
### Ejercicio 9
```SQL
SELECT E.CODEMPLE, E.NOMBRE, D.DENOMINACION, C.LOCALIDAD, CA.DENON FROM EMPLEADO E JOIN DPTO D ON E.CODDPTO=D.CODDPTO JOIN CENTRO C ON D.CODCENTRO=C.CODCENTRO JOIN CATEGORIA CA ON E.CODCATE=CA.CODCATE;
```
### Ejercicio 10
```SQL
SELECT E1.CODEMPLE, E1.NOMBRE, E1.LOCALIDAD, E1.CODCATE, E2.CODEMPLE, E2.NOMBRE, E2.LOCALIDAD, E2.CODCATE FROM EMPLEADO E1, EMPLEADO E2 WHERE E1.LOCALIDAD=E2.LOCALIDAD AND E1.CODCATE!=E2.CODCATE AND E1.CODEMPLE!=E2.CODEMPLE;
```
## 29 preguntas:
### Ejercicio 1
```sql
SELECT E.NOMBRE, E.SALARIO FROM EMPLEADO E WHERE SALARIO>1000 ORDER BY NOMBRE ASC;
```
### Ejercicio 2
```SQL
SELECT E.NOMBRE, E.SALARIO, E.COMISION FROM EMPLEADO E WHERE E.COMISION>E.SALARIO*0.2;
```
### Ejercicio 3
```SQL
SELECT E.CODEMPLE, E.CODDPTO, E.NOMBRE, E.SALARIO*166 AS SUELDO_PESETAS FROM EMPLEADO E WHERE E.SALARIO+E.COMISION>1800 ORDER BY E.CODDPTO, E.NOMBRE;
```
### Ejercicio 4
```SQL
SELECT E.NOMBRE, E.SALARIO FROM EMPLEADO E WHERE E.SALARIO>=1.05*(SELECT SALARIO FROM EMPLEADO WHERE NOMBRE='MARIA JAZMIN');
```
### Ejercicio 5
```SQL
SELECT E.NOMBRE, E.APE1, E.APE2, E.ANTIGUEDAD FROM EMPLEADO E ORDER BY E.ANTIGUEDAD;
```
### Ejercicio 6
### Ejercicio 7
### Ejercicio 8
### Ejercicio 9
### Ejercicio 10
### Ejercicio 11
### Ejercicio 12
### Ejercicio 13
### Ejercicio 14
### Ejercicio 15
### Ejercicio 16
### Ejercicio 17
### Ejercicio 18
### Ejercicio 19
### Ejercicio 20
### Ejercicio 21
### Ejercicio 22
### Ejercicio 23
### Ejercicio 24
### Ejercicio 25
### Ejercicio 26
### Ejercicio 27
### Ejercicio 28
### Ejercicio 29
